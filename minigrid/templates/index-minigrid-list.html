{% extends 'base.html' %}

{% block body %}
<div id="content">
  <div class="contentbox">
  <p><a href="/users">Manage users &raquo;</a></p>
  {% if not system %}
    <strong>You must initialize the system tariff information.</strong>
    <form action="/tariffs" method="POST">
      {% module xsrf_form_html() %}
      {% include tariff_form.html %}
    </form>
  {% else %}
    <p><a href="/tariffs">Manage tariffs &raquo;</a></p>
    <p><a href="/technician">Write technician ID card &raquo;</a></p>
    <p><a href="/device">Manage devices &raquo;</a></p>
    <p><a href="/cards">Read and validate cards &raquo;</a></p>
  </div>

  <div class="contentbox">
    <p>Minigrids:</p>
    <ul>
      {% set zero_minigrids = True %}
      {% for grid in minigrids %}
        {% set zero_minigrids = False %}
        <li>
          <p><a href="/minigrids/{{ grid.minigrid_id }}">{{ grid.minigrid_name }} &raquo;</a></p>
          <p>Status: {{ grid.status }}</p>
        </li>
      {% end %}
    </ul>
    {% if zero_minigrids %}
      <p>No minigrids</p>
    {% end %}
  </div>

  <div class="contentbox">

    {% if message is not None %}
    <p><strong>Could not create minigrid: {{ message }}</strong></p>
    {% end %}
    <p>Add minigrid:</p>
    <form action="/minigrids" method="POST">
      {% module xsrf_form_html() %}
      <label>Name: <input name="minigrid_name" required /></label><br>
      <label>AES key: <input name="minigrid_aes_key" required /></label><br>
      <input type="submit" value="Add Minigrid" />
    </form>

  </div>
</div>

    <!-- <p>Aggregate data plots:</p>
    <p>TODO: What data? From where?</p> -->
  {% end %}
{% end %}
