{% extends 'base.html' %}

{% block body %}

<nav class="sidebar">
  <ul>
    <li><a href="/users">&laquo; Manage users</a>

{% if not system %}
    
  </ul>
  <div id="tariff-message">You must initialize the system tariff information.</div>
</nav>

  <div class="content" id="tariff-form">
      <form action="/tariffs" method="POST">
        {% module xsrf_form_html() %}
        {% include tariff_form.html %}
      </form>
  </div>

{% else %}

    <li><a href="/tariffs">&laquo; Manage tariffs</a></li>
    <!-- <li><a href="/technician">Write technician ID card &raquo;</a></li> -->
    <li><a href="/device">&laquo; Manage devices</a></li>
    <li><a href="/cards">&laquo; Read and validate cards</a><li>
  </ul>
</nav>

<div class="minigrid-index">

  <div class="contentbox">
    <h3>Minigrids:</h3>
    <ul>
      {% set zero_minigrids = True %}
      {% for grid in minigrids %}
        {% set zero_minigrids = False %}
        <li>
          <p><a href="/minigrids/{{ grid.minigrid_id }}">{{ grid.minigrid_name }} &raquo;</a></p>
          <!-- <p>Status: {{ grid.status }}</p> -->
        </li>
      {% end %}
    </ul>
    {% if zero_minigrids %}
      <p>No minigrids</p>
    {% end %}
  </div>

  <div class="contentbox">

    {% if message is not None %}
    <p><strong>Could not create minigrid: {{ message }}</strong></p>
    {% end %}
    <h3>Add minigrid:</h3>
    <form action="/minigrids" method="POST">
      {% module xsrf_form_html() %}
      <label>Name: <input name="minigrid_name" required /></label><br>
      <label>Payment system ID: <input name="minigrid_payment_id" pattern="[a-f0-9]{8}-?[a-f0-9]{4}-?4[a-f0-9]{3}-?[89ab][a-f0-9]{3}-?[a-f0-9]{12}" required title="UUID format" /></label><br>
      <input type="submit" value="Add Minigrid" />
    </form>

  </div>
</div>

    <!-- <p>Aggregate data plots:</p>
    <p>TODO: What data? From where?</p> -->
{% end %}
{% end %}
